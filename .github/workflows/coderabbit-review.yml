name: CodeRabbit AI Review

on:
  pull_request:
    types: [opened, synchronize, reopened]
  pull_request_review_comment:
    types: [created]

permissions:
  contents: read
  pull-requests: write

jobs:
  review:
    runs-on: ubuntu-latest
    name: CodeRabbit AI Code Review

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0

      - name: CodeRabbit AI Review
        uses: coderabbitai/ai-pr-reviewer@latest
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        with:
          debug: false
          review_simple_changes: false
          review_comment_lgtm: false
          openai_light_model: gpt-3.5-turbo
          openai_heavy_model: gpt-4
          openai_model_temperature: 0.2
          openai_retries: 3
          openai_timeout_ms: 120000
          openai_concurrency_limit: 4
          system_message: |
            ë‹¹ì‹ ì€ @coderabbitaiì…ë‹ˆë‹¤. ì—°ìˆ˜ê¹€ì•ˆê³¼ AI ëœë”©í˜ì´ì§€ í”„ë¡œì íŠ¸ì˜ ì½”ë“œ ë¦¬ë·°ë¥¼ ë‹´ë‹¹í•˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

            ë‹¤ìŒ ê°€ì´ë“œë¼ì¸ì„ ë”°ë¼ ë¦¬ë·°í•´ì£¼ì„¸ìš”:

            **ê¸°ìˆ  ìŠ¤íƒ:**
            - Next.js 14 (App Router)
            - TypeScript 5.0+
            - Tailwind CSS 3.4
            - Supabase (ë°±ì—”ë“œ)
            - OpenAI GPT-4o (AI ì±—ë´‡)
            - shadcn/ui (UI ì»´í¬ë„ŒíŠ¸)

            **ë¦¬ë·° í¬ì»¤ìŠ¤:**
            1. ğŸ”’ **ë³´ì•ˆ**: ê°œì¸ì •ë³´ ë³´í˜¸, SQL ì¸ì ì…˜, XSS ë°©ì§€
            2. âš¡ **ì„±ëŠ¥**: Core Web Vitals, ë²ˆë“¤ í¬ê¸°, ì´ë¯¸ì§€ ìµœì í™”
            3. ğŸ¯ **ì ‘ê·¼ì„±**: WCAG 2.1 AA ì¤€ìˆ˜, í‚¤ë³´ë“œ ë‚´ë¹„ê²Œì´ì…˜
            4. ğŸ§© **ì½”ë“œ í’ˆì§ˆ**: TypeScript íƒ€ì… ì•ˆì „ì„±, ì¬ì‚¬ìš©ì„±
            5. ğŸ¨ **UI/UX**: ì˜ë£Œ ë¸Œëœë“œ ê°€ì´ë“œë¼ì¸ ì¤€ìˆ˜
            6. ğŸ“± **ë°˜ì‘í˜•**: ëª¨ë°”ì¼ ìš°ì„  ë””ìì¸

            **ì˜ë£Œ ê·œì • ì¤€ìˆ˜:**
            - ê³¼ì¥ ê´‘ê³  ê¸ˆì§€
            - ê°œì¸ì •ë³´ë³´í˜¸ë²• ì¤€ìˆ˜
            - ì˜ë£Œë²• ì¤€ìˆ˜

            **ì–¸ì–´**: í•œêµ­ì–´ë¡œ ë¦¬ë·° ì œê³µ
          summarize: |
            ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ PR ìš”ì•½ì„ ì œê³µí•´ì£¼ì„¸ìš”:

            ## ğŸ” CodeRabbit AI ë¦¬ë·° ìš”ì•½

            ### ğŸ“Š ë³€ê²½ì‚¬í•­ ê°œìš”
            - ìˆ˜ì •ëœ íŒŒì¼: Xê°œ
            - ì¶”ê°€ëœ ì¤„: +XXX
            - ì‚­ì œëœ ì¤„: -XXX

            ### â­ ì£¼ìš” ê°œì„ ì‚¬í•­
            - [ê°œì„ ì‚¬í•­ 1]
            - [ê°œì„ ì‚¬í•­ 2]

            ### âš ï¸ ì£¼ì˜ì‚¬í•­
            - [ì£¼ì˜ì‚¬í•­ 1]
            - [ì£¼ì˜ì‚¬í•­ 2]

            ### ğŸ¯ ê¶Œì¥ì‚¬í•­
            - [ê¶Œì¥ì‚¬í•­ 1]
            - [ê¶Œì¥ì‚¬í•­ 2]
          summarize_release_notes: |
            ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

            ## ğŸš€ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸

            ### âœ¨ ìƒˆë¡œìš´ ê¸°ëŠ¥
            - [ìƒˆ ê¸°ëŠ¥ë“¤]

            ### ğŸ› ë²„ê·¸ ìˆ˜ì •
            - [ìˆ˜ì •ëœ ë²„ê·¸ë“¤]

            ### ğŸ”§ ê°œì„ ì‚¬í•­
            - [ê°œì„ ëœ í•­ëª©ë“¤]

            ### âš ï¸ ì£¼ì˜ì‚¬í•­
            - [ì£¼ì˜í•  ì ë“¤]
